% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pecv.R
\name{pECV}
\alias{pECV}
\title{Entrywise Splitting Cross-Validation to determine the number of factors in generalized factor models}
\usage{
pECV(
  resp,
  C = 5,
  qmax = 8,
  fold = 5,
  tol_val = 0.01,
  theta0 = NULL,
  A0 = NULL,
  seed = 1,
  data_type = NULL
)
}
\arguments{
\item{resp}{Observation data matrix (n x p), can be continuous data, count data, or binary data}

\item{C}{Constraint constant, default is 5}

\item{qmax}{Maximum number of factors, default is 8}

\item{fold}{Number of folds in cross-validation, default is 5}

\item{tol_val}{Convergence tolerance, default is 0.01 (represents 0.01/number of estimated elements)}

\item{theta0}{Initial values matrix for factors, generated from uniform distribution if not provided}

\item{A0}{Initial values matrix for loadings, generated from uniform distribution if not provided}

\item{seed}{Random seed, default is 1}

\item{data_type}{Data type, options are "continuous", "count", "binary". Function will auto-detect if not specified}
}
\value{
Returns a list containing:
  \item{ECV}{Number of factors selected by standard ECV}
  \item{p1ECV}{Number of factors selected by ECV with penalty 1}
  \item{p2ECV}{Number of factors selected by ECV with penalty 2}
  \item{p3ECV}{Number of factors selected by ECV with penalty 3}
  \item{p4ECV}{Number of factors selected by ECV with penalty 4}
  \item{ECV_loss}{CV loss values for each number of factors}
  \item{data_type}{Identified data type}
}
\description{
Uses (Penalized) Entrywise Splitting Cross-Validation method to estimate the number of factors in generalized factor models
}
\examples{
set.seed(123)
# Generate count data
n <- 50; p <- 50; q <- 2
theta_true <- cbind(1,matrix(runif(n * q,-2,2), n, q))
A_true <- matrix(runif(p * (q+1),-2,2), p, (q+1))
lambda <- exp(theta_true \%*\% t(A_true))
resp <- matrix(
rpois(length(lambda), lambda = as.vector(lambda)),
nrow = nrow(lambda), ncol = ncol(lambda))
result <- pECV(resp, C = 4, qmax = 4, fold = 5)
print(result)
}
